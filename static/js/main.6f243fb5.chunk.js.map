{"version":3,"sources":["lib/elementary.jsx","lib/utils.tsx","lib/patch.tsx","ui/Grid.tsx","ui/Splainer.tsx","lib/tones.js","lib/modules.js","lib/useSynth.jsx","ui/Logo.tsx","ui/Synth.tsx","App.tsx","ui/Splash.tsx","index.jsx"],"names":["core","tempoToMs","tempo","subDiv","beatLen","noteToMidi","n","notes","split","name","octave","indexOf","Number","midiToFrequency","m","Math","pow","range","start","Array","from","keys","map","k","clamp","min","max","patchReducer","patch","action","type","tracks","tone","useKick","Error","getUrlState","state","p","window","URLSearchParams","location","search","noteParams","getAll","length","rslt","s","number","i","bit","numberToBits","e","console","log","kickParams","Boolean","presetParams","Key","memo","hasHilight","note","step","onDrawStart","onDrawEnter","handleMouseDown","useCallback","handleMouseEnter","keyClasses","classnames","keyStyle","className","style","onMouseEnter","onMouseDown","Field","onToggleNote","useState","paintMode","setPaintMode","handleMouseUp","useEffect","document","addEventListener","removeEventListener","handleDrawStart","handlePaint","key","Grid","hilightStep","fieldStyle","cursorStyle","Splainer","href","stab","freq","gain","detune","sharpness","richness","t","toneGain","el","mul","add","sin","PI","out","phasor","tanh","highpass","desc","ding","osc","cycle","kick","gate","speed","pop","tail","ampEnv","adsr","fastEnv","slowEnv","pitch","tones","synth","scale","tick","sync","env","seq","loop","current","voice","useSynth","withKick","bpm","useRef","metro","interval","beat","doRender","nodes","node","balance","dly","delay","size","ms2samps","fx","drums","master","render","__renderer","LogoTitle","viewBox","xmlns","id","cx","cy","r","gradientUnits","gradientTransform","stopColor","offset","d","fill","LogoGrid","Logo","KickSwitch","active","setActive","checked","onChange","htmlFor","label","TonePicker","currentTone","onSetTone","value","Synth","onClear","onSetKick","onClick","numNotes","floor","flat","makeScale","metroCallback","source","on","initTracks","App","useReducer","updatePatch","setTick","toggleNote","newTracks","track","bits","reduce","prev","cur","toString","join","newLocation","pathname","globalThis","history","replaceState","setUrlState","onTick","keyrange","PlayButton","width","height","x","y","in","result","slope","values","stdDeviation","filter","Splash","props","ctx","AudioContext","RenderApp","ReactDOM","StrictMode","getElementById","a","initialize","numberOfInputs","numberOfOutputs","outputChannelCount","connect","destination","resume","then","main"],"mappings":"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","file":"static/js/main.6f243fb5.chunk.js","sourcesContent":["import { ElementaryWebAudioRenderer as core } from \"@nick-thompson/elementary\";\n\nexport default core;\n","/**\n * Calculate the length, in ms, of one given subdivision at the specificed BPM\n * @param {*} tempo tempo in Beats Per Minute\n * @param {*} subDiv subdivision for which the length is sought, defaults to 16:th note\n * @returns the length of one subdivision in ms\n */\nexport const tempoToMs = (tempo: number, subDiv = 16) => {\n  const beatLen = 1 / (tempo / 60);\n  return ((beatLen * 4) / subDiv) * 1000;\n};\n\nexport const makeScale = (scale: string[], numNotes: number, octave = 4) => {\n  return range(numNotes)\n    .map(\n      (i) =>\n        `${scale[i % scale.length]}${Math.floor(i / scale.length) + octave}`\n    )\n    .flat()\n    .map(noteToMidi)\n    .map(midiToFrequency);\n};\n\nexport const noteToMidi = (n: string) => {\n  let notes = [\"c\", \"c#\", \"d\", \"d#\", \"e\", \"f\", \"f#\", \"g\", \"g#\", \"a\", \"a#\", \"b\"];\n  let [name, octave] = n.split(\"\");\n\n  if (notes.indexOf(name) < 0) return -1;\n\n  return 12 * Number(octave) + notes.indexOf(name);\n};\n\nexport const midiToFrequency = (m: number) => {\n  if (m < 0) {\n    return 0;\n  }\n  return 440 * Math.pow(2, (m - 69) / 12);\n};\n\nexport const range = (n: number, start: number = 0) => [\n  ...Array.from(Array(n).keys()).map((k) => k + start),\n];\n\nexport const clamp = (n: number, min = 0, max = 1) =>\n  Math.max(Math.min(n, max), min);\n\nexport const bitsToNumber = (bits: number[]) => {\n  return bits.reduce((prev, cur, i) => prev | (cur << i));\n};\n\nexport const numberToBits = (number: number, length = 16) => {\n  return range(length).map((i) => {\n    const bit = 1 << i;\n    return (number & bit) === bit ? 1 : 0;\n  });\n};\n","import { Reducer } from \"react\";\nimport { bitsToNumber, numberToBits } from \"./utils\";\n\nexport type Patch = {\n  tracks: number[][];\n  useKick: boolean;\n  tone: string;\n};\n\nexport type Action =\n  | { type: \"setTracks\"; tracks: number[][] }\n  | { type: \"setTone\"; tone: string }\n  | { type: \"setUseKick\"; useKick: boolean };\n\nexport const patchReducer: Reducer<Patch, Action> = (patch, action) => {\n  switch (action.type) {\n    case \"setTracks\":\n      return { ...patch, tracks: action.tracks };\n    case \"setTone\":\n      return { ...patch, tone: action.tone };\n    case \"setUseKick\":\n      return { ...patch, useKick: action.useKick };\n    default:\n      throw new Error(\n        `Tried to perform ${action}, which is not a valid action`\n      );\n  }\n};\n\nexport const getUrlState = () => {\n  const state: Partial<Patch> = {};\n  const p = new window.URLSearchParams(window.location.search);\n\n  const noteParams = p.getAll(\"tracks\");\n  if (noteParams.length > 0) {\n    try {\n      const rslt = noteParams[0].split(\",\").map((s) => numberToBits(Number(s)));\n      state.tracks = rslt;\n    } catch (e) {\n      console.log(\"Recall failed: \", e);\n    }\n  }\n\n  const kickParams = p.getAll(\"kick\");\n  if (kickParams.length > 0) {\n    state.useKick = Boolean(Number(kickParams[0]));\n  }\n\n  const presetParams = p.getAll(\"tone\");\n  if (presetParams.length > 0) {\n    state.tone = presetParams[0];\n  }\n\n  return state;\n};\n\nexport const setUrlState = (patch: Patch) => {\n  const tracks = patch.tracks\n    .map((track) => bitsToNumber(track).toString())\n    .join(\",\");\n  const kick = patch.useKick ? 1 : 0;\n  const tone = patch.tone;\n  const newLocation =\n    window.location.pathname + `?tracks=${tracks}&kick=${kick}&tone=${tone}`;\n  globalThis.history.replaceState(null, \"\", newLocation);\n};\n","import classnames from \"classnames\";\nimport { CSSProperties, memo, useCallback, useEffect, useState } from \"react\";\n\nimport { range } from \"../lib/utils\";\n\nimport \"./Grid.scss\";\n\ntype KeyProps = {\n  note: number;\n  state: boolean;\n  step: number;\n  hasHilight?: boolean;\n  onDrawStart: (note: number, step: number) => void;\n  onDrawEnter: (note: number, step: number) => void;\n};\n\nconst Key = memo(\n  ({ hasHilight, note, state, step, onDrawStart, onDrawEnter }: KeyProps) => {\n    const handleMouseDown = useCallback(\n      () => onDrawStart(note, step),\n      [note, onDrawStart, step]\n    );\n\n    const handleMouseEnter = useCallback(\n      () => onDrawEnter(note, step),\n      [note, onDrawEnter, step]\n    );\n\n    const keyClasses = classnames({\n      \"eg-key\": true,\n      \"eg-key--is-active\": state,\n      \"eg-key--has-hilight\": hasHilight,\n    });\n\n    const keyStyle = {\n      \"--step\": step,\n      \"--note\": note,\n    } as CSSProperties;\n\n    return (\n      <div\n        className={keyClasses}\n        style={keyStyle}\n        onMouseEnter={handleMouseEnter}\n        onMouseDown={handleMouseDown}\n      />\n    );\n  }\n);\n\ntype FieldProps = {\n  notes: number[][];\n  onToggleNote: (note: number, step: number, mode: number) => void;\n};\n\nconst Field = ({ notes, onToggleNote }: FieldProps) => {\n  const [paintMode, setPaintMode] = useState<PaintMode>(\"none\");\n\n  const handleMouseUp = useCallback(() => setPaintMode(\"none\"), []);\n\n  useEffect(() => {\n    document.addEventListener(\"mouseup\", handleMouseUp);\n\n    return () => {\n      document.removeEventListener(\"mouseup\", handleMouseUp);\n    };\n  }, [handleMouseUp]);\n\n  const handleDrawStart = useCallback(\n    (note: number, step: number) => {\n      if (notes[note][step] === 0) {\n        onToggleNote(note, step, 1);\n        setPaintMode(\"fill\");\n      } else {\n        onToggleNote(note, step, 0);\n        setPaintMode(\"clear\");\n      }\n    },\n    [notes, onToggleNote]\n  );\n\n  const handlePaint = useCallback(\n    (note: number, step: number) => {\n      if (paintMode === \"fill\" && notes[note][step] === 0) {\n        onToggleNote(note, step, 1);\n      }\n\n      if (paintMode === \"clear\" && notes[note][step] === 1) {\n        onToggleNote(note, step, 0);\n      }\n    },\n    [notes, onToggleNote, paintMode]\n  );\n\n  return (\n    <>\n      {range(notes.length).map((note) => {\n        return range(notes[0].length).map((step) => {\n          const state = notes[note][step] === 1;\n          const key = `${note}_${step}_${state ? \"on\" : \"off\"}`;\n          return (\n            <Key\n              key={key}\n              note={note}\n              state={state}\n              step={step}\n              onDrawStart={handleDrawStart}\n              onDrawEnter={handlePaint}\n            />\n          );\n        });\n      })}\n    </>\n  );\n};\n\ntype PaintMode = \"none\" | \"fill\" | \"clear\";\n\ntype Props = {\n  notes: number[][];\n  keyrange?: number;\n  hilightStep?: number;\n  onToggleNote: (note: number, step: number, mode: number) => void;\n};\n\nconst Grid = ({ notes, hilightStep, onToggleNote }: Props) => {\n  const fieldStyle = {\n    \"--columns\": notes[0].length,\n    \"--rows\": notes.length,\n  } as CSSProperties;\n\n  const cursorStyle = {\n    \"--cursor\": hilightStep,\n  } as CSSProperties;\n\n  return (\n    <div className=\"eg-grid\" style={fieldStyle}>\n      <Field notes={notes} onToggleNote={onToggleNote} />\n      <div className=\"eg-grid__cursor\" style={cursorStyle} />\n    </div>\n  );\n};\n\nexport default Grid;\n","import \"./Splainer.scss\";\n\nconst Splainer = () => {\n  return (\n    <div className=\"eg-splainer\">\n      <span>\n        Made with <a href=\"https://www.elementary.audio/\">Elementary Audio</a>\n      </span>\n      <span>\n        Source on <a href=\"https://github.com/teetow/elementary_grid\">GitHub</a>\n      </span>\n      <span>\n        Check out my <a href=\"https://soundcloud.com/teetow\">SoundCloud</a>\n        {\" =)\"}\n      </span>\n    </div>\n  );\n};\n\nexport default Splainer;\n","import { el } from \"@nick-thompson/elementary\";\n\n/**\n * @typedef {Object} PluckProps\n * @property {number} [detune]\n * @property {number} [sharpness]\n * */\n\n/**\n *\n * @param {number} freq\n * @param {PluckProps} props\n */\nexport const stab = (\n  freq,\n  { gain = 1.0, detune = 0.007, sharpness = 1.0, richness = 1.0 } = {}\n) => {\n  const tone = (t, toneGain) =>\n    el.mul(\n      toneGain,\n      el.add(\n        el.sin(el.mul(2 * Math.PI, t)),\n        el.sin(el.mul(3 * Math.PI, t, 0.1 * sharpness))\n      )\n    );\n  let out = el.add(\n    el.mul(tone(el.phasor(freq * (1 - detune)), 0.5 * richness)),\n    el.mul(tone(el.phasor(freq * 1), 0.8)),\n    el.mul(tone(el.phasor(freq * (1 + detune)), 0.5 * richness))\n  );\n\n  out = el.tanh(out);\n  out = el.highpass(60, 1.0, out);\n\n  return el.mul(gain * 2, out);\n};\nstab.desc = \"Not quite a supersaw, but certainly a stabby little rascal\";\n\n/**\n * @typedef {Object} DingProps\n * @property {number} [gain]\n * @property {number} [richness]\n * @property {number} [detune]\n */\n\n/**\n * @param {number} freq\n * @param {DingProps} [props]\n */\nexport const ding = (\n  freq,\n  { gain = 1.0, richness = 1.0, detune = 0.004 } = {}\n) => {\n  let osc = el.add(\n    el.cycle(freq * (1 - detune)),\n    el.mul(0.5 * richness, el.cycle(2 * freq * (1 - detune * 0.5))),\n    el.mul(0.5 * richness, el.cycle(2 * freq * (1 + detune * 0.5))),\n    el.cycle(freq * (1 + detune))\n  );\n\n  osc = el.highpass(200, 1.0, osc);\n  osc = el.mul(osc, gain * 2);\n  osc = el.tanh(osc);\n\n  return osc;\n};\nding.desc = \"Pseudo-FM bell-like patch with a sprinkle of unpredictability\";\n\n/**\n * @typedef {Object} KickProps\n * @property {number} [freq]\n * @property {number} [pop]\n * @property {number} [speed]\n * */\n\n/**\n *\n * @param {Object} gate\n * @param {Kickprops} [props]\n */\nexport const kick = (\n  gate,\n  { freq = 45, speed = 1.0, pop = 1.0, tail = 1.0 } = {}\n) => {\n  let ampEnv = el.adsr(0.005, 0.3 * speed, 0.0, 0.0, gate);\n  let fastEnv = el.adsr(0.0001, 0.2 * speed, 0.0, 0.0, gate);\n  let slowEnv = el.adsr(0.0001, 0.5, 0.0, 0.0, gate);\n\n  let pitch = el.add(1.0, el.mul(3 * pop, fastEnv));\n  pitch = el.add(0.0, el.mul(0.5 * pop, slowEnv), pitch);\n\n  let out = el.cycle(el.mul(pitch, freq));\n\n  out = el.tanh(el.mul(1.8, ampEnv, out));\n  out = el.highpass(freq + 10, tail * 6.0, out);\n  out = el.tanh(out);\n\n  return out;\n};\n","import { el } from \"@nick-thompson/elementary\";\nimport { clamp, range, tempoToMs } from \"./utils\";\n\nimport { ding, kick, stab } from \"./tones\";\n\nconst tones = {\n  stab: stab,\n  ding: ding,\n  kick: kick,\n};\n\n/**\n * @typedef {Object} Props\n * @property {number[][]} tracks\n * @property {Function} tone\n * @property {number[]} scale\n * @property {Object} tick\n * @property {Object} sync\n */\n\n/**\n *\n * @param {Props} props\n * @returns {Object} An Elementary node\n */\nexport const synth = ({ tracks, tone, scale, tick, sync }) => {\n  const seq = (i) =>\n    el.seq(\n      { key: `${i}:seq`, seq: tracks[i], loop: false },\n      tick.current,\n      sync.current\n    );\n  const env = (i) => el.adsr(0.01, 0.3, 0.1, 1.0, seq(i));\n  const osc = (freq) => tones[tone](freq, { gain: 0.8 });\n  const voice = (i) => osc(scale[i]);\n  const patch = (i) => el.mul(env(i), voice(i));\n\n  return el.add(\n    el.add(range(4, 0).map(patch)),\n    el.add(range(4, 4).map(patch)),\n    el.add(range(4, 8).map(patch)),\n    el.add(range(4, 12).map(patch))\n  );\n};\n\nexport const fx = (node, bpm = 120, balance = 1.0) => {\n  let dly = el.delay(\n    { size: 44100 },\n    el.ms2samps(3 * tempoToMs(bpm, 16)),\n    -0.3,\n    node\n  );\n\n  return el.add(el.mul(node, clamp(2 - balance)), el.mul(dly, balance, 0.5));\n};\n\nexport const drums = (beat) => {\n  return kick(beat.current, { pop: 1.3 });\n};\n\nexport const master = (node, tick, beat, sync) => {\n  return el.add(\n    el.mul(0, tick.current),\n    el.mul(0, beat.current),\n    el.mul(0, sync.current),\n    node\n  );\n};\n","import {\n  el,\n  ElementaryWebAudioRenderer as core,\n} from \"@nick-thompson/elementary\";\nimport { useCallback, useEffect, useRef } from \"react\";\n\nimport { drums, fx, master, synth } from \"./modules\";\nimport { tempoToMs } from \"./utils\";\n\n/**\n * @typedef {Object} Props\n *\n * @property {number[][]} tracks\n * @property {number[]} scale\n * @property {boolean} [withKick]\n * @property {number} [bpm]\n * @property {string} [tone]\n */\n\n/**\n * @param {Props} props\n */\nexport const useSynth = ({\n  tracks,\n  scale,\n  withKick = true,\n  bpm = 120,\n  tone = \"ding\",\n}) => {\n  const tick = useRef(el.metro({ name: \"tick\", interval: tempoToMs(bpm, 16) }));\n  const beat = useRef(el.metro({ name: \"beat\", interval: tempoToMs(bpm, 4) }));\n  const sync = useRef(el.metro({ name: \"sync\", interval: tempoToMs(bpm, 1) }));\n\n  const doRender = useCallback(() => {\n    try {\n      let nodes = synth({ tracks, tone, scale, tick, sync });\n\n      nodes = fx(nodes, bpm, 1.0);\n\n      nodes = el.tanh(el.mul(0.4, nodes));\n\n      if (withKick) {\n        nodes = el.add(nodes, drums(beat));\n      }\n\n      nodes = master(nodes, tick, beat, sync);\n\n      core.render(nodes, nodes);\n    } catch (e) {\n      console.log(e);\n    }\n  }, [tracks, tone, scale, bpm, withKick]);\n\n  useEffect(() => {\n    if (core.__renderer) {\n      doRender();\n    }\n  }, [tracks, tone, scale, bpm, withKick, doRender]);\n};\n","import \"./Logo.scss\";\n\nconst LogoTitle = () => {\n  return (\n    <svg\n      className=\"eg-logo__text\"\n      viewBox=\"-4 2 94 10\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <radialGradient\n        id=\"grad-text\"\n        cx=\"0\"\n        cy=\"0\"\n        r=\"1\"\n        gradientUnits=\"userSpaceOnUse\"\n        gradientTransform=\"translate(20 0) rotate(10.5392) scale(42.4514 15.2674)\"\n      >\n        <stop stopColor=\"var(--gd-text-s0)\" />\n        <stop offset=\"1\" stopColor=\"var(--gd-text-s1)\" />\n      </radialGradient>\n\n      <g id=\"text\">\n        <path\n          d=\"M5.28333 7.69336H2.15247V10.332H5.85754V12H0.1427V2.04688H5.84387V3.72168H2.15247V6.07324H5.28333V7.69336Z\"\n          fill=\"url(#grad-text)\"\n        />\n        <path\n          d=\"M10.0094 10.332H13.5368V12H7.99965V2.04688H10.0094V10.332Z\"\n          fill=\"url(#grad-text)\"\n        />\n        <path\n          d=\"M20.8195 7.69336H17.6886V10.332H21.3937V12H15.6789V2.04688H21.38V3.72168H17.6886V6.07324H20.8195V7.69336Z\"\n          fill=\"url(#grad-text)\"\n        />\n        <path\n          d=\"M26.1608 2.04688L28.0407 9.24512L29.9138 2.04688H32.5388V12H30.5222V9.30664L30.7067 5.15723L28.7175 12H27.3503L25.361 5.15723L25.5456 9.30664V12H23.5358V2.04688H26.1608Z\"\n          fill=\"url(#grad-text)\"\n        />\n        <path\n          d=\"M40.2795 7.69336H37.1486V10.332H40.8537V12H35.1389V2.04688H40.84V3.72168H37.1486V6.07324H40.2795V7.69336Z\"\n          fill=\"url(#grad-text)\"\n        />\n        <path\n          d=\"M49.9548 12H47.945L45.0056 5.47168V12H42.9958V2.04688H45.0056L47.9519 8.58203V2.04688H49.9548V12Z\"\n          fill=\"url(#grad-text)\"\n        />\n        <path\n          d=\"M58.7893 3.72168H56.3284V12H54.3118V3.72168H51.8918V2.04688H58.7893V3.72168Z\"\n          fill=\"url(#grad-text)\"\n        />\n        <path\n          d=\"M64.8552 9.96289H62.114L61.5808 12H59.4548L62.5652 2.04688H64.4041L67.5349 12H65.3884L64.8552 9.96289ZM62.5515 8.28809H64.4109L63.4812 4.74023L62.5515 8.28809Z\"\n          fill=\"url(#grad-text)\"\n        />\n        <path\n          d=\"M72.4661 8.36328H71.468V12H69.4583V2.04688H72.6643C73.6715 2.04688 74.4485 2.30892 74.9954 2.83301C75.5468 3.35254 75.8225 4.0931 75.8225 5.05469C75.8225 6.3763 75.3417 7.30143 74.3802 7.83008L76.1233 11.9043V12H73.9632L72.4661 8.36328ZM71.468 6.68848H72.6096C73.0107 6.68848 73.3115 6.55632 73.512 6.29199C73.7125 6.02311 73.8128 5.66536 73.8128 5.21875C73.8128 4.2207 73.4231 3.72168 72.6438 3.72168H71.468V6.68848Z\"\n          fill=\"url(#grad-text)\"\n        />\n        <path\n          d=\"M80.8563 6.51758L82.3533 2.04688H84.5408L81.8748 8.39062V12H79.8377V8.39062L77.1649 2.04688H79.3524L80.8563 6.51758Z\"\n          fill=\"url(#grad-text)\"\n        />\n      </g>\n    </svg>\n  );\n};\n\nconst LogoGrid = () => {\n  return (\n    <svg\n      className=\"eg-logo__grid\"\n      viewBox=\"86 0 36 14\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <radialGradient\n        id=\"led-full\"\n        gradientUnits=\"objectBoundingBox\"\n        gradientTransform=\"translate(-0.25 -0.3) scale(1.41421)\"\n      >\n        <stop stopColor=\"var(--gd-full-s0)\" />\n        <stop offset=\"1\" stopColor=\"var(--gd-full-s1)\" />\n      </radialGradient>\n\n      <radialGradient id=\"led-half\" gradientUnits=\"objectBoundingBox\">\n        <stop stopColor=\"var(--gd-half-s0)\" />\n        <stop offset=\"1\" stopColor=\"var(--gd-half-s1)\" />\n      </radialGradient>\n\n      <radialGradient id=\"led-off\" gradientUnits=\"objectBoundingBox\">\n        <stop stopColor=\"var(--gd-off-s0)\" />\n        <stop offset=\"1\" stopColor=\"var(--gd-off-s1)\" />\n      </radialGradient>\n\n      <g id=\"off-leds\">\n        <path d=\"M88 0H86V2H88V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M88 10H86V12H88V10Z\" fill=\"url(#led-off)\" />\n        <path d=\"M88 2H86V4H88V2Z\" fill=\"url(#led-off)\" />\n        <path d=\"M88 4H86V6H88V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M88 6H86V8H88V6Z\" fill=\"url(#led-off)\" />\n        <path d=\"M88 8H86V10H88V8Z\" fill=\"url(#led-off)\" />\n        <path d=\"M90 0H88V2H90V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M90 12H88V14H90V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M92 0H90V2H92V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M92 12H90V14H92V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M92 4H90V6H92V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M92 6H90V8H92V6Z\" fill=\"url(#led-off)\" />\n        <path d=\"M92 8H90V10H92V8Z\" fill=\"url(#led-off)\" />\n        <path d=\"M94 0H92V2H94V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M94 12H92V14H94V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M94 4H92V6H94V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M94 8H92V10H94V8Z\" fill=\"url(#led-off)\" />\n        <path d=\"M96 0H94V2H96V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M96 12H94V14H96V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M96 4H94V6H96V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M98 0H96V2H98V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M98 10H96V12H98V10Z\" fill=\"url(#led-off)\" />\n        <path d=\"M98 12H96V14H98V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M98 2H96V4H98V2Z\" fill=\"url(#led-off)\" />\n        <path d=\"M98 4H96V6H98V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M98 6H96V8H98V6Z\" fill=\"url(#led-off)\" />\n        <path d=\"M98 8H96V10H98V8Z\" fill=\"url(#led-off)\" />\n        <path d=\"M100 0H98V2H100V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M100 12H98V14H100V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M102 0H100V2H102V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M102 10H100V12H102V10Z\" fill=\"url(#led-off)\" />\n        <path d=\"M102 12H100V14H102V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M102 4H100V6H102V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M102 8H100V10H102V8Z\" fill=\"url(#led-off)\" />\n        <path d=\"M104 0H102V2H104V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M104 10H102V12H104V10Z\" fill=\"url(#led-off)\" />\n        <path d=\"M104 12H102V14H104V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M104 4H102V6H104V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M104 8H102V10H104V8Z\" fill=\"url(#led-off)\" />\n        <path d=\"M106 0H104V2H106V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M106 12H104V14H106V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M108 0H106V2H108V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M108 10H106V12H108V10Z\" fill=\"url(#led-off)\" />\n        <path d=\"M108 12H106V14H108V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M108 2H106V4H108V2Z\" fill=\"url(#led-off)\" />\n        <path d=\"M108 4H106V6H108V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M108 6H106V8H108V6Z\" fill=\"url(#led-off)\" />\n        <path d=\"M108 8H106V10H108V8Z\" fill=\"url(#led-off)\" />\n        <path d=\"M110 0H108V2H110V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M110 12H108V14H110V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M112 0H110V2H112V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M112 10H110V12H112V10Z\" fill=\"url(#led-off)\" />\n        <path d=\"M112 12H110V14H112V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M112 2H110V4H112V2Z\" fill=\"url(#led-off)\" />\n        <path d=\"M112 4H110V6H112V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M112 6H110V8H112V6Z\" fill=\"url(#led-off)\" />\n        <path d=\"M112 8H110V10H112V8Z\" fill=\"url(#led-off)\" />\n        <path d=\"M114 0H112V2H114V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M114 12H112V14H114V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M116 0H114V2H116V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M116 12H114V14H116V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M116 4H114V6H116V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M116 6H114V8H116V6Z\" fill=\"url(#led-off)\" />\n        <path d=\"M116 8H114V10H116V8Z\" fill=\"url(#led-off)\" />\n        <path d=\"M118 0H116V2H118V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M118 12H116V14H118V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M118 4H116V6H118V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M118 6H116V8H118V6Z\" fill=\"url(#led-off)\" />\n        <path d=\"M118 8H116V10H118V8Z\" fill=\"url(#led-off)\" />\n        <path d=\"M120 0H118V2H120V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M120 12H118V14H120V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M122 0H120V2H122V0Z\" fill=\"url(#led-off)\" />\n        <path d=\"M122 10H120V12H122V10Z\" fill=\"url(#led-off)\" />\n        <path d=\"M122 12H120V14H122V12Z\" fill=\"url(#led-off)\" />\n        <path d=\"M122 2H120V4H122V2Z\" fill=\"url(#led-off)\" />\n        <path d=\"M122 4H120V6H122V4Z\" fill=\"url(#led-off)\" />\n        <path d=\"M122 6H120V8H122V6Z\" fill=\"url(#led-off)\" />\n        <path d=\"M122 8H120V10H122V8Z\" fill=\"url(#led-off)\" />\n      </g>\n      <g id=\"half-leds\">\n        <path d=\"M106 2H104V4H106V2Z\" fill=\"url(#led-half)\" />\n        <path d=\"M90 2H88V4H90V2Z\" fill=\"url(#led-half)\" />\n        <path d=\"M90 10H88V12H90V10Z\" fill=\"url(#led-half)\" />\n        <path d=\"M96 10H94V12H96V10Z\" fill=\"url(#led-half)\" />\n        <path d=\"M120 10H118V12H120V10Z\" fill=\"url(#led-half)\" />\n        <path d=\"M120 2H118V4H120V2Z\" fill=\"url(#led-half)\" />\n        <path d=\"M106 6H104V8H106V6Z\" fill=\"url(#led-half)\" />\n      </g>\n      <g id=\"full-leds\">\n        <path d=\"M92 2H90V4H92V2Z\" fill=\"url(#led-full)\" />\n        <path d=\"M94 2H92V4H94V2Z\" fill=\"url(#led-full)\" />\n        <path d=\"M96 2H94V4H96V2Z\" fill=\"url(#led-full)\" />\n        <path d=\"M100 2H98V4H100V2Z\" fill=\"url(#led-full)\" />\n        <path d=\"M114 2H112V4H114V2Z\" fill=\"url(#led-full)\" />\n        <path d=\"M110 2H108V4H110V2Z\" fill=\"url(#led-full)\" />\n        <path d=\"M102 2H100V4H102V2Z\" fill=\"url(#led-full)\" />\n        <path d=\"M116 2H114V4H116V2Z\" fill=\"url(#led-full)\" />\n        <path d=\"M104 2H102V4H104V2Z\" fill=\"url(#led-full)\" />\n        <path d=\"M118 2H116V4H118V2Z\" fill=\"url(#led-full)\" />\n        <path d=\"M106 4H104V6H106V4Z\" fill=\"url(#led-full)\" />\n        <path d=\"M120 4H118V6H120V4Z\" fill=\"url(#led-full)\" />\n        <path d=\"M102 6H100V8H102V6Z\" fill=\"url(#led-full)\" />\n        <path d=\"M116 10H114V12H116V10Z\" fill=\"url(#led-full)\" />\n        <path d=\"M104 6H102V8H104V6Z\" fill=\"url(#led-full)\" />\n        <path d=\"M118 10H116V12H118V10Z\" fill=\"url(#led-full)\" />\n        <path d=\"M106 8H104V10H106V8Z\" fill=\"url(#led-full)\" />\n        <path d=\"M120 6H118V8H120V6Z\" fill=\"url(#led-full)\" />\n        <path d=\"M106 10H104V12H106V10Z\" fill=\"url(#led-full)\" />\n        <path d=\"M120 8H118V10H120V8Z\" fill=\"url(#led-full)\" />\n        <path d=\"M100 4H98V6H100V4Z\" fill=\"url(#led-full)\" />\n        <path d=\"M114 4H112V6H114V4Z\" fill=\"url(#led-full)\" />\n        <path d=\"M110 4H108V6H110V4Z\" fill=\"url(#led-full)\" />\n        <path d=\"M100 6H98V8H100V6Z\" fill=\"url(#led-full)\" />\n        <path d=\"M114 6H112V8H114V6Z\" fill=\"url(#led-full)\" />\n        <path d=\"M110 6H108V8H110V6Z\" fill=\"url(#led-full)\" />\n        <path d=\"M100 8H98V10H100V8Z\" fill=\"url(#led-full)\" />\n        <path d=\"M114 8H112V10H114V8Z\" fill=\"url(#led-full)\" />\n        <path d=\"M110 8H108V10H110V8Z\" fill=\"url(#led-full)\" />\n        <path d=\"M100 10H98V12H100V10Z\" fill=\"url(#led-full)\" />\n        <path d=\"M114 10H112V12H114V10Z\" fill=\"url(#led-full)\" />\n        <path d=\"M110 10H108V12H110V10Z\" fill=\"url(#led-full)\" />\n        <path d=\"M90 4H88V6H90V4Z\" fill=\"url(#led-full)\" />\n        <path d=\"M90 6H88V8H90V6Z\" fill=\"url(#led-full)\" />\n        <path d=\"M94 6H92V8H94V6Z\" fill=\"url(#led-full)\" />\n        <path d=\"M96 8H94V10H96V8Z\" fill=\"url(#led-full)\" />\n        <path d=\"M96 6H94V8H96V6Z\" fill=\"url(#led-full)\" />\n        <path d=\"M94 10H92V12H94V10Z\" fill=\"url(#led-full)\" />\n        <path d=\"M92 10H90V12H92V10Z\" fill=\"url(#led-full)\" />\n        <path d=\"M90 8H88V10H90V8Z\" fill=\"url(#led-full)\" />\n      </g>\n    </svg>\n  );\n};\nexport const Logo = () => {\n  return (\n    <div className=\"eg-logo\">\n      <LogoTitle />\n      <LogoGrid />\n    </div>\n  );\n};\n","import { Patch } from \"../lib/patch\";\nimport { useSynth } from \"../lib/useSynth\";\nimport { Logo } from \"./Logo\";\n\nimport \"./Synth.scss\";\n\nconst KickSwitch = ({\n  active,\n  setActive,\n}: {\n  active: boolean;\n  setActive: (active: boolean) => void;\n}) => {\n  return (\n    <div className=\"eg-synth__option eg-synth__kick-switch\">\n      <input\n        className=\"eg-synth__switch\"\n        type=\"checkbox\"\n        id=\"kick\"\n        checked={active}\n        onChange={() => setActive(!active)}\n      />\n      <label htmlFor=\"kick\">Kick</label>\n    </div>\n  );\n};\n\ntype ToneName = \"stab\" | \"ding\";\n\ntype Tone = {\n  name: ToneName;\n  label: string;\n};\n\nconst tones = [\n  { name: \"stab\", label: \"Stab\" },\n  { name: \"ding\", label: \"Ding\" },\n] as Array<Tone>;\n\ntype TonePickerProps = {\n  currentTone: ToneName;\n  onSetTone: (name: ToneName) => void;\n};\n\nconst TonePicker = ({ currentTone, onSetTone }: TonePickerProps) => {\n  return (\n    <div className=\"eg-synth__tone-picker\">\n      {tones.map((tone) => {\n        return (\n          <div className=\"eg-synth__option\" key={tone.name}>\n            <input\n              type=\"radio\"\n              className=\"eg-synth__led\"\n              id={tone.name}\n              value={tone.name}\n              checked={tone.name === currentTone}\n              onChange={() => onSetTone(tone.name)}\n            />\n            <label htmlFor={tone.name}>{tone.label}</label>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\ntype Props = {\n  patch: Patch;\n  scale: number[];\n  onClear: () => void;\n  onSetKick: (useKick: boolean) => void;\n  onSetTone: (tone: string) => void;\n};\n\nfunction Synth({ patch, scale, onClear, onSetKick, onSetTone }: Props) {\n  useSynth({\n    scale: scale,\n    tone: patch.tone,\n    tracks: patch.tracks,\n    withKick: patch.useKick,\n  });\n\n  return (\n    <div className=\"eg-synthoptions\">\n      <Logo />\n      <button\n        type=\"button\"\n        className=\"eg-button eg-synth__clearbutton\"\n        onClick={onClear}\n      >\n        Clear\n      </button>\n      <TonePicker currentTone={patch.tone as ToneName} onSetTone={onSetTone} />\n      <KickSwitch active={patch.useKick} setActive={onSetKick} />\n    </div>\n  );\n}\n\nexport default Synth;\n","import { useCallback, useEffect, useReducer, useState } from \"react\";\nimport core from \"./lib/elementary\";\n\nimport { getUrlState, Patch, patchReducer, setUrlState } from \"./lib/patch\";\nimport { makeScale } from \"./lib/utils\";\nimport Grid from \"./ui/Grid\";\nimport Splainer from \"./ui/Splainer\";\nimport Synth from \"./ui/Synth\";\n\nimport \"./App.scss\";\n\nconst numTracks = 16;\nconst numSteps = 16;\n\nconst scale = makeScale([\"c\", \"d\", \"f\", \"g\", \"a\"], numTracks);\n\nlet metroCallback = (source: string) => {};\n\ncore.on(\"load\", () => {\n  core.on(\"metro\", (e: { source: string }) => {\n    metroCallback(e.source);\n  });\n});\n\nconst initTracks = () => {\n  return Array.from(Array(numTracks), () => new Array(numSteps).fill(0));\n};\n\nconst getPatch = () => {\n  return {\n    tracks: initTracks(),\n    tone: \"stab\",\n    useKick: false,\n    ...getUrlState(),\n  } as Patch;\n};\n\nconst App = () => {\n  const [patch, updatePatch] = useReducer(patchReducer, getPatch());\n  const [tick, setTick] = useState<number>(0);\n\n  const toggleNote = useCallback(\n    (note: number, step: number, value: number) => {\n      const newTracks = [...patch.tracks];\n      newTracks[note][step] = value;\n\n      updatePatch({ type: \"setTracks\", tracks: newTracks });\n    },\n    [patch.tracks]\n  );\n\n  useEffect(() => {\n    setUrlState(patch);\n  }, [patch]);\n\n  const onTick = useCallback(\n    (source: string) => {\n      if (source === \"sync\") {\n        setTick(0);\n      } else if (source === \"tick\") {\n        setTick((prev) => (prev + 1) % patch.tracks.length);\n      }\n    },\n    [patch.tracks]\n  );\n\n  metroCallback = onTick;\n\n  return (\n    <div className=\"eg-app\">\n      <Synth\n        scale={scale}\n        patch={patch}\n        onClear={() => updatePatch({ type: \"setTracks\", tracks: initTracks() })}\n        onSetKick={(useKick) => updatePatch({ type: \"setUseKick\", useKick })}\n        onSetTone={(tone) => updatePatch({ type: \"setTone\", tone })}\n      />\n\n      <Grid\n        keyrange={16}\n        notes={patch.tracks}\n        onToggleNote={toggleNote}\n        hilightStep={tick}\n      />\n      <Splainer />\n    </div>\n  );\n};\n\nexport default App;\n","import \"./Splash.scss\";\n\nconst PlayButton = () => {\n  const blur = 3.3;\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      className=\"eg-splash__playbutton\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      width=\"24\"\n      height=\"24\"\n    >\n      <defs>\n        <radialGradient\n          id=\"grad\"\n          cx=\"0\"\n          cy=\"0\"\n          r=\"1\"\n          gradientUnits=\"userSpaceOnUse\"\n          gradientTransform=\"translate(11 12) rotate(45) scale(7)\"\n        >\n          <stop stopColor=\"var(--color-grad-s1)\" />\n          <stop offset=\"1\" stopColor=\"var(--color-grad-s0)\" />\n        </radialGradient>\n      </defs>\n\n      <filter id=\"dropshadow\" x=\"-100%\" y=\"-100%\" height=\"400%\" width=\"400%\">\n        <feComponentTransfer in=\"SourceAlpha\" result=\"alpha\">\n          <feFuncA type=\"linear\" slope=\"0.4\" />\n        </feComponentTransfer>\n        <feColorMatrix\n          in=\"alpha\"\n          type=\"matrix\"\n          values=\"\n      1 0 0 0 1\n      0 1 0 0 0.5\n      0 0 1 0 0.2\n      0 0 0 1 0\n      \"\n          result=\"mask\"\n        />\n        <feGaussianBlur in=\"mask\" stdDeviation={blur} />\n\n        <feMerge>\n          <feMergeNode />\n          <feMergeNode in=\"SourceGraphic\" />\n        </feMerge>\n      </filter>\n      <path\n        className=\"eg-path__primary\"\n        d=\"M8 4L19 12L8 20Z\"\n        style={{ filter: \"url(#dropshadow)\" }}\n      />\n    </svg>\n  );\n};\n\nexport const Splash = ({ ...props }) => {\n  return (\n    <div className=\"eg-splash\" {...props}>\n      <h3 className=\"eg-splash__title\">Hello.</h3>\n      <PlayButton />\n      <h3 className=\"eg-splash__title-2\">Click this.</h3>\n      <h3 className=\"eg-splash__title-3\">It'll be fun.</h3>\n    </div>\n  );\n};\n","import { ElementaryWebAudioRenderer as core } from \"@nick-thompson/elementary\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\nimport { Splash } from \"./ui/Splash\";\n\nlet ctx = new AudioContext();\n\nconst RenderApp = () => {\n  ReactDOM.render(\n    <React.StrictMode>\n      <App />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n  );\n};\n\ncore.on(\"load\", () => {\n  if (ctx.state !== \"running\") {\n    ReactDOM.render(\n      <Splash onClick={() => ctx.resume().then(() => RenderApp())} />,\n      document.getElementById(\"root\")\n    );\n  } else {\n    RenderApp();\n  }\n});\n\nasync function main() {\n  let node = await core.initialize(ctx, {\n    numberOfInputs: 0,\n    numberOfOutputs: 1,\n    outputChannelCount: [2],\n  });\n  node.connect(ctx.destination);\n}\n\nmain();\n"],"sourceRoot":""}